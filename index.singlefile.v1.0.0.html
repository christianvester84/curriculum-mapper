<!DOCTYPE html>
<html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Orbis Curriculum Mapper — Single File</title>
<style id="inlineStyles">
:root{--b1:#25417D;--b2:#3561B5;--b3:#7F9ED9;--b4:#D4DFF2;--g:#3C3C3C;--bg:#f8f9fb}
*{box-sizing:border-box}body{margin:0;background:var(--bg);color:#12203E;font:16px/1.45 Arial,Helvetica,sans-serif}
.topbar{display:flex;justify-content:space-between;align-items:center;padding:10px 16px;background:var(--b1);color:#fff}
.brand{display:flex;align-items:center;gap:10px}.logo{width:28px;height:28px;border-radius:50%;background:radial-gradient(circle,#fff 0 40%,var(--b1) 41%)}
.actions .btn{margin-left:8px}.btn{background:var(--b2);color:#fff;border:none;border-radius:6px;padding:8px 12px;cursor:pointer}
.btn.small{padding:6px 10px;font-size:14px}.btn.outline{background:#fff;color:var(--b1);border:1px solid var(--b1)}.btn.primary{background:var(--b1)}
main{padding:16px}.grid{display:grid;gap:16px;grid-template-columns:1fr 1fr 1fr}
.panel{background:#fff;border:1px solid #d7dce6;border-radius:8px;padding:12px}
.row{display:grid;grid-template-columns:160px 1fr;gap:10px;align-items:center;margin:10px 0}
.input,select{padding:8px;border:1px solid #d7dce6;border-radius:6px;width:100%}
.table{width:100%;border-collapse:collapse;margin-top:8px}.table th,.table td{border:1px solid #d7dce6;padding:6px 8px}
.chips{display:flex;flex-wrap:wrap;gap:6px}.chip{border:1px solid var(--b3);background:var(--b4);padding:3px 8px;border-radius:999px;cursor:pointer}
.badge{display:inline-block;border-radius:4px;padding:2px 6px;font-size:12px}
.badge.I{background:var(--b4)}.badge.R{background:var(--b3)}.badge.A{background:var(--b2);color:#fff}
@media(max-width:1200px){.grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<header class="topbar"><div class="brand"><div class="logo"></div><div class="title"><strong>ORBI</strong>S Education</div></div>
<nav class="actions"><button id="btnExportCSV" class="btn small">Export CSV</button>
<button id="btnExportPDF" class="btn small">Export PDF</button>
<button id="btnImport" class="btn small outline">Import</button>
<button id="btnExportJSON" class="btn small outline">Export JSON</button></nav></header>
<main>
<h1>Curriculum Mapping <small style="color:#5f6b83">Built 2026-02-18 19:44:55</small></h1>
<h2 class="course">Course: <span id="courseName"></span></h2>
<section class="grid">
<section class="panel"><h3>Course Learning Outcomes (CLOs)</h3>
<ol id="cloList" class="list"></ol>
<div class="panel-actions"><input id="newCloText" class="input" placeholder="Add new CLO..."><button id="btnAddClo" class="btn">+ Add CLO</button></div>
<hr><h3>Assignments</h3>
<ul id="asgList" class="list"></ul>
<div class="panel-actions"><input id="newAsgText" class="input" placeholder="Add new assignment..."><button id="btnAddAsg" class="btn">+ Add Assignment</button></div>
</section>
<section class="panel"><h3>Mapping Editor</h3>
<div class="row"><label>Target</label><select id="mapTarget"><option value="CLO">CLO</option><option value="Assignment">Assignment</option></select><select id="mapTargetId"></select></div>
<div class="row"><label>Level</label><select id="level"><option value="">Unset</option><option value="L1">Level 1</option><option value="L2">Level 2</option></select></div>
<div class="row"><label>Domain</label><select id="domain"></select></div>
<div class="row"><label>Competency</label><select id="competency"></select></div>
<div class="row"><label>Sub competency</label><select id="subcompetency"></select></div>
<div class="row"><label>Concepts</label><div id="concepts" class="chips"></div></div>
<div class="row"><label>Spheres of Care</label><div id="spheres" class="chips"></div></div>
<div class="row"><label>Alignment</label><div><label><input type="radio" name="strength" value="I"> Introduced</label> <label><input type="radio" name="strength" value="R"> Reinforced</label> <label><input type="radio" name="strength" value="A"> Assessed</label></div></div>
<div class="row"><label>Evidence (PI IDs)</label><input id="evidence" class="input" placeholder="e.g., PI-5.2b-01; PI-5.2b-03"></div>
<div class="panel-actions"><button id="btnSaveMap" class="btn primary">Save Mapping</button><button id="btnDeleteMap" class="btn" style="background:#a33">Delete All Mappings for Target</button></div>
<h4>Existing Mappings (selected target)</h4><table class="table" id="mapTable"></table>
</section>
<section class="panel"><h3>Reports</h3><div id="coverage"></div><div id="assignmentTable"></div><div id="summaries"></div></section>
</section>
</main>
<script>
(function(){
  var DOMAINS=[
    {id:1,name:'Knowledge for Nursing Practice'},
    {id:2,name:'Person-Centered Care'},
    {id:3,name:'Population Health'},
    {id:4,name:'Scholarship for the Nursing Discipline'},
    {id:5,name:'Quality & Safety'},
    {id:6,name:'Interprofessional Partnerships'},
    {id:7,name:'Systems-Based Practice'},
    {id:8,name:'Informatics & Healthcare Technologies'},
    {id:9,name:'Professionalism'},
    {id:10,name:'Personal, Professional & Leadership Development'}];
  var CONCEPTS=['Clinical Judgment','Communication','Compassionate Care','Diversity, Equity & Inclusion','Ethics','Evidence-Based Practice','Health Policy','Social Determinants of Health'];
  var SPHERES=['Disease prevention / health promotion','Chronic disease care','Regenerative/restorative care','Hospice/palliative/supportive care'];
  var COMP_MAP={
    5:[{code:'5.1',label:'Quality improvement',subs:[{code:'5.1a',level:'L1'},{code:'5.1d',level:'L2'}]},
       {code:'5.2',label:'Patient safety culture',subs:[{code:'5.2b',level:'L1'},{code:'5.2f',level:'L2'}]}],
    8:[{code:'8.1',label:'Use information & tech',subs:[{code:'8.1a',level:'L1'},{code:'8.1e',level:'L2'}]},
       {code:'8.2',label:'Coordinate care w/ tech',subs:[{code:'8.2b',level:'L1'},{code:'8.2f',level:'L2'}]}],
    9:[{code:'9.2',label:'Ethical & professional conduct',subs:[{code:'9.2-01',level:'L1'},{code:'9.2-02',level:'L2'}]}],
    1:[{code:'1.2',label:'Apply theory & research',subs:[{code:'1.2a',level:'L1'},{code:'1.2e',level:'L2'}]}],
    2:[{code:'2.3',label:'Assessment skills',subs:[{code:'2.3a',level:'L1'},{code:'2.3e',level:'L2'}]}],
    3:[{code:'3.3',label:'Socioeconomic impact',subs:[{code:'3.3a',level:'L1'},{code:'3.3c',level:'L2'}]}]
  };
  var DEMO={
    course:{id:'NURS-386',name:'NURS 386 - Childbearing Health in Transitions (Demo)'},
    clos:[
      {id:'CLO1',text:'Analyse cultural, religious, ethical, social issues that impact clients and childbearing families.'},
      {id:'CLO2',text:'Incorporate knowledge from humanities and sciences to discuss appropriate holistic therapeutics.'},
      {id:'CLO3',text:'Examine factors related to quality, safety, effectiveness and efficiency in planning and delivering holistic care.'},
      {id:'CLO4',text:'Discuss therapeutic communication methods used professionally and therapeutically within the childbearing family.'}
    ],
    assignments:[
      {id:'ASG1',title:'Client Pamphlet for PMS'},
      {id:'ASG2',title:'Nursing Care Plan: Pregnancy-Related HTN'},
      {id:'ASG3',title:'FHR/UC Tracing Interpretation'},
      {id:'ASG4',title:'Ethical Dilemma Discussion'}
    ],
    mappings:[
      {targetType:'CLO',targetId:'CLO3',level:'L1',domain:5,competency:'5.2',sub:'5.2b',concepts:['Evidence-Based Practice','Clinical Judgment'],spheres:['Regenerative/restorative care'],strength:'R',pi:['PI-5.2b-01']},
      {targetType:'Assignment',targetId:'ASG3',level:'L1',domain:8,competency:'8.2',sub:'8.2b',concepts:['Communication','Evidence-Based Practice'],spheres:['Regenerative/restorative care'],strength:'A',pi:['PI-8.2b-01']},
      {targetType:'Assignment',targetId:'ASG2',level:'L1',domain:5,competency:'5.1',sub:'5.1a',concepts:['Clinical Judgment'],spheres:['Regenerative/restorative care'],strength:'A',pi:['PI-5.1a-03']},
      {targetType:'Assignment',targetId:'ASG4',level:'L1',domain:9,competency:'9.2',sub:'9.2-01',concepts:['Ethics','Diversity, Equity & Inclusion'],spheres:['Disease prevention / health promotion'],strength:'R',pi:['PI-9.2-01']}
    ]
  };
  var state=null; try{state=JSON.parse(localStorage.getItem('orbis_mapper_state_v1'))}catch(e){}
  if(!state){state=JSON.parse(JSON.stringify(DEMO));localStorage.setItem('orbis_mapper_state_v1',JSON.stringify(state));}
  // DOM
  function el(id){return document.getElementById(id)}
  var courseName=el('courseName'), cloList=el('cloList'), asgList=el('asgList');
  var mapTarget=el('mapTarget'), mapTargetId=el('mapTargetId');
  var levelSel=el('level'), domainSel=el('domain'), compSel=el('competency'), subSel=el('subcompetency');
  var conceptsDiv=el('concepts'), spheresDiv=el('spheres'), evidence=el('evidence');
  var mapTable=el('mapTable'), coverageDiv=el('coverage'), assignmentTableDiv=el('assignmentTable'), summariesDiv=el('summaries');
  // Actions
  el('btnExportCSV').onclick=exportCSV; el('btnExportJSON').onclick=function(){download('mappings.json',JSON.stringify(state,null,2),'application/json')};
  el('btnImport').onclick=importJSON; el('btnExportPDF').onclick=exportPDF;
  function persist(){localStorage.setItem('orbis_mapper_state_v1',JSON.stringify(state)); renderAll();}
  function fillDomains(){domainSel.innerHTML=DOMAINS.map(function(d){return '<option value="'+d.id+'">'+d.id+'. '+d.name+'</option>'}).join('')}
  fillDomains();
  function fillTargetIds(){var t=mapTarget.value; var list=t==='CLO'?state.clos:state.assignments; mapTargetId.innerHTML=list.map(function(x){return '<option value="'+x.id+'">'+(t==='CLO'?x.text.slice(0,60):x.title)+'</option>'}).join('')}
  mapTarget.onchange=function(){fillTargetIds(); renderMapTable();}
  function buildChips(container,items){container.innerHTML=''; items.forEach(function(n){var s=document.createElement('span'); s.className='chip'; s.textContent=n; s.dataset.value=n; s.onclick=function(){s.classList.toggle('active')}; container.appendChild(s);});}
  buildChips(conceptsDiv,CONCEPTS); buildChips(spheresDiv,SPHERES);
  function refreshCompAndSub(){var dom=parseInt(domainSel.value,10); var comps=(COMP_MAP[dom]||[]); compSel.innerHTML=comps.map(function(c){return '<option value="'+c.code+'">'+c.code+' - '+c.label+'</option>'}).join(''); refreshSub();}
  function refreshSub(){var dom=parseInt(domainSel.value,10); var level=levelSel.value; var comp=(COMP_MAP[dom]||[]).find(function(c){return c.code===compSel.value}); var subs=(comp?comp.subs:[]).filter(function(s){return !level || s.level===level}); subSel.innerHTML=subs.map(function(s){return '<option value="'+s.code+'">'+s.code+'</option>'}).join('');}
  levelSel.onchange=refreshCompAndSub; domainSel.onchange=refreshCompAndSub; compSel.onchange=refreshSub;
  el('btnAddClo').onclick=function(){var t=el('newCloText').value.trim(); if(!t) return; state.clos.push({id:'CLO'+(state.clos.length+1),text:t}); el('newCloText').value=''; persist();};
  el('btnAddAsg').onclick=function(){var t=el('newAsgText').value.trim(); if(!t) return; state.assignments.push({id:'ASG'+(state.assignments.length+1),title:t}); el('newAsgText').value=''; persist();};
  el('btnSaveMap').onclick=function(){
    var strength=(document.querySelector('input[name="strength"]:checked')||{}).value||'';
    var selConcepts=[].slice.call(conceptsDiv.querySelectorAll('.chip.active')).map(function(c){return c.dataset.value});
    var selSpheres=[].slice.call(spheresDiv.querySelectorAll('.chip.active')).map(function(c){return c.dataset.value});
    var m={targetType:mapTarget.value,targetId:mapTargetId.value,level:levelSel.value,domain:parseInt(domainSel.value,10),competency:compSel.value,sub:subSel.value,concepts:selConcepts,spheres:selSpheres,strength:strength,pi:evidence.value.split(/;|,\s*/).map(function(s){return s.trim()}).filter(Boolean)};
    var idx=state.mappings.findIndex(function(x){return x.targetType===m.targetType && x.targetId===m.targetId && x.domain===m.domain && x.competency===m.competency && x.sub===m.sub});
    if(idx>=0) state.mappings[idx]=m; else state.mappings.push(m); persist(); };
  el('btnDeleteMap').onclick=function(){var t=mapTarget.value,id=mapTargetId.value; state.mappings=state.mappings.filter(function(x){return !(x.targetType===t && x.targetId===id)}); persist(); };
  function renderLists(){courseName.textContent=state.course.name; cloList.innerHTML=state.clos.map(function(c){return '<li>'+c.text+'</li>'}).join(''); asgList.innerHTML=state.assignments.map(function(a){return '<li>'+a.title+'</li>'}).join('');}
  function renderMapTable(){var t=mapTarget.value,id=mapTargetId.value; var rows=state.mappings.filter(function(m){return m.targetType===t && m.targetId===id}); var head='<tr><th>Level</th><th>Domain</th><th>Comp</th><th>Sub</th><th>Concepts</th><th>Spheres</th><th>Strength</th><th>PIs</th></tr>'; var body=rows.map(function(m){return '<tr><td>'+ (m.level||'') +'</td><td>'+m.domain+'</td><td>'+m.competency+'</td><td>'+m.sub+'</td><td>'+ (m.concepts||[]).join(', ') +'</td><td>'+ (m.spheres||[]).join(', ') +'</td><td><span class="badge '+(m.strength||'')+'">'+(m.strength||'')+'</span></td><td>'+ (m.pi||[]).join(', ') +'</td></tr>'}).join(''); mapTable.innerHTML=head+body; }
  function renderCoverage(){var rank={I:1,R:2,A:3}; var header='<table class="table"><tr><th></th>'+DOMAINS.map(function(d){return '<th>D'+d.id+'</th>'}).join('')+'</tr>'; var rows=state.clos.map(function(clo){var cells=DOMAINS.map(function(d){var mlist=state.mappings.filter(function(m){return m.targetType==='CLO' && m.targetId===clo.id && m.domain===d.id}); var max=''; mlist.forEach(function(m){ if((rank[m.strength]||0)>(rank[max]||0)) max=m.strength;}); var badge=max?'<span class="badge '+max+'">'+max+'</span>':'-'; return '<td>'+badge+'</td>';}).join(''); return '<tr><td>'+clo.text.slice(0,28)+'…</td>'+cells+'</tr>';}).join(''); coverageDiv.innerHTML='<h4>CLO x Domain Coverage</h4>'+header+rows+'</table>'; }
  function renderAssignments(){var head='<tr><th>Assignment</th><th>Level</th><th>Domain</th><th>Comp</th><th>Sub</th><th>PIs</th></tr>'; var rows=state.assignments.flatMap?state.assignments.flatMap:function(mapper){var a=[]; state.assignments.forEach(function(x){a=a.concat(mapper(x));}); return a;}; var r=rows.call(state.assignments,function(a){var maps=state.mappings.filter(function(m){return m.targetType==='Assignment' && m.targetId===a.id}); if(!maps.length) return ['<tr><td>'+a.title+'</td><td colspan="5" style="text-align:left;color:#666">— no mapping —</td></tr>']; return maps.map(function(m,i){return '<tr><td>'+ (i?'':a.title) +'</td><td>'+ (m.level||'') +'</td><td>D'+m.domain+'</td><td>'+m.competency+'</td><td>'+m.sub+'</td><td>'+ (m.pi||[]).join(', ') +'</td></tr>'});}); assignmentTableDiv.innerHTML='<h4>Assignment Alignment</h4><table class="table">'+r.join('')+'</table>'; }
  function renderSummaries(){var cCounts={}, sCounts={}, i; CONCEPTS.forEach(function(c){cCounts[c]=0}); SPHERES.forEach(function(s){sCounts[s]=0}); state.mappings.forEach(function(m){(m.concepts||[]).forEach(function(c){cCounts[c]=(cCounts[c]||0)+1}); (m.spheres||[]).forEach(function(s){sCounts[s]=(sCounts[s]||0)+1});}); function bars(obj){var max=1; for(i in obj){if(obj[i]>max) max=obj[i]} var out='<ul style="list-style:none;padding-left:0">'; for(i in obj){out+='<li style="margin:6px 0">'+i+'<div style="height:8px;background:#e9edf5;border-radius:4px"><div style="height:8px;width:'+((obj[i]/max)*100)+'%;background:'+ '#3561B5' +';border-radius:4px"></div></div></li>'} return out+'</ul>'}
    summariesDiv.innerHTML='<h4>Concept Coverage</h4>'+bars(cCounts)+'<h4>Sphere of Care Coverage</h4>'+bars(sCounts);
  }
  function renderAll(){renderLists(); fillTargetIds(); refreshCompAndSub(); renderMapTable(); renderCoverage(); renderAssignments(); renderSummaries();}
  // CSV
  function exportCSV(){var rows=[['TargetType','Target','Level','Domain','Competency','Sub','Concepts','Spheres','Strength','PIs']]; state.mappings.forEach(function(m){var targetName=(m.targetType==='CLO'?(state.clos.find(function(c){return c.id===m.targetId})||{}).text:(state.assignments.find(function(a){return a.id===m.targetId})||{}).title)||m.targetId; rows.push([m.targetType,targetName,m.level||'', 'D'+m.domain, m.competency, m.sub, (m.concepts||[]).join('|'), (m.spheres||[]).join('|'), m.strength||'', (m.pi||[]).join('|')]);}); var csv=rows.map(function(r){return r.map(function(x){return '"'+String(x).replace(/"/g,'""')+'"'}).join(',')}).join('
'); download('mappings.csv',csv,'text/csv');}
  // PDF (print)
  function exportPDF(){var w=window.open('','_blank'); var css='<style>'+document.getElementById('inlineStyles').textContent+'</style>'; var cover='<h1>Curriculum Mapping Report</h1><h2>'+state.course.name+'</h2>'; w.document.write('<!DOCTYPE html><html><head><meta charset="utf-8"><title>Report</title>'+css+'</head><body>'); w.document.write('<div class="panel">'+cover+'<p>Generated '+(new Date()).toLocaleString()+'</p></div>'); w.document.write('<div class="panel">'+coverageDiv.innerHTML+'</div>'); w.document.write('<div class="panel">'+assignmentTableDiv.innerHTML+'</div>'); w.document.write('<div class="panel">'+summariesDiv.innerHTML+'</div>'); var rows=state.mappings.map(function(m){return '<tr><td>'+m.targetType+'</td><td>'+m.targetId+'</td><td>D'+m.domain+' '+m.competency+'.'+m.sub+'</td><td>'+ (m.pi||[]).join(', ') +'</td></tr>'}).join(''); w.document.write('<div class="panel"><h4>Evidence Appendix (PI IDs)</h4><table class="table"><tr><th>Target</th><th>ID</th><th>Alignment</th><th>PIs</th></tr>'+rows+'</table></div>'); w.document.write('</body></html>'); w.document.close(); w.focus(); setTimeout(function(){w.print()},350); }
  function download(name,data,type){var blob=new Blob([data],{type:type}); var a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download=name; a.click(); setTimeout(function(){URL.revokeObjectURL(a.href)},1000);}
  function importJSON(){var inp=document.createElement('input'); inp.type='file'; inp.accept='.json,application/json'; inp.onchange=function(){var f=inp.files[0]; if(!f) return; var fr=new FileReader(); fr.onload=function(){ try{state=JSON.parse(fr.result); localStorage.setItem('orbis_mapper_state_v1',JSON.stringify(state)); renderAll(); }catch(e){ alert('Invalid JSON'); } }; fr.readAsText(f); }; inp.click();}
  renderAll();
})();
</script>
</body></html>